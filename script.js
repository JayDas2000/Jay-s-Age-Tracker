// Full JavaScript code goes here (omitted due to space)